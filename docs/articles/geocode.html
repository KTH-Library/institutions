<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Geocoding usage example • institutions</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Geocoding usage example">
<meta property="og:description" content="institutions">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">institutions</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/institutions.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/geocode.html">Geocoding usage example</a>
    </li>
    <li>
      <a href="../articles/meta.html">Description of the GRID db</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/KTH-Library/institutions/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Geocoding usage example</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/KTH-Library/institutions/blob/master/vignettes/geocode.Rmd"><code>vignettes/geocode.Rmd</code></a></small>
      <div class="hidden name"><code>geocode.Rmd</code></div>

    </div>

    
    
<p>Two convenience functions are provided that allows address information to be used as basis for a geocoding lookup that can return coordinates. Let’s say address information is provided for an institution or institute that is not present in the GRID database. The following example shows how these geocoding functions can be used to look up geocoding information:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">institutions</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>


<span class="co"># using Nominatim API (Open Street Map)</span>
<span class="no">osm</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="../reference/geocode_nominatim.html">geocode_nominatim</a></span>(<span class="st">"Kungliga Tekniska Högskolan"</span>)

<span class="co"># coordinates etc</span>
<span class="no">osm</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>()
<span class="co">#&gt; Rows: 1</span>
<span class="co">#&gt; Columns: 24</span>
<span class="co">#&gt; $ place_id              &lt;int&gt; 162168231</span>
<span class="co">#&gt; $ licence               &lt;chr&gt; "Data © OpenStreetMap contributors, ODbL 1.0. h…</span>
<span class="co">#&gt; $ osm_type              &lt;chr&gt; "way"</span>
<span class="co">#&gt; $ osm_id                &lt;int&gt; 317156082</span>
<span class="co">#&gt; $ boundingbox           &lt;list&gt; [&lt;"59.3454636", "59.3542387", "18.0623594", "1…</span>
<span class="co">#&gt; $ lat                   &lt;chr&gt; "59.34986645"</span>
<span class="co">#&gt; $ lon                   &lt;chr&gt; "18.07063213298418"</span>
<span class="co">#&gt; $ display_name          &lt;chr&gt; "Kungliga Tekniska högskolan, Norrtullstunneln,…</span>
<span class="co">#&gt; $ class                 &lt;chr&gt; "amenity"</span>
<span class="co">#&gt; $ type                  &lt;chr&gt; "university"</span>
<span class="co">#&gt; $ importance            &lt;dbl&gt; 0.7991388</span>
<span class="co">#&gt; $ icon                  &lt;chr&gt; "https://nominatim.openstreetmap.org/images/map…</span>
<span class="co">#&gt; $ address.amenity       &lt;chr&gt; "Kungliga Tekniska högskolan"</span>
<span class="co">#&gt; $ address.road          &lt;chr&gt; "Norrtullstunneln"</span>
<span class="co">#&gt; $ address.city_block    &lt;chr&gt; "Kattrumpstullen"</span>
<span class="co">#&gt; $ address.suburb        &lt;chr&gt; "Norra Djurgården"</span>
<span class="co">#&gt; $ address.city_district &lt;chr&gt; "Norrmalms stadsdelsområde"</span>
<span class="co">#&gt; $ address.city          &lt;chr&gt; "Stockholm"</span>
<span class="co">#&gt; $ address.municipality  &lt;chr&gt; "Stockholms kommun"</span>
<span class="co">#&gt; $ address.state         &lt;chr&gt; "Stockholms län"</span>
<span class="co">#&gt; $ address.region        &lt;chr&gt; "Svealand"</span>
<span class="co">#&gt; $ address.postcode      &lt;chr&gt; "114 19"</span>
<span class="co">#&gt; $ address.country       &lt;chr&gt; "Sverige"</span>
<span class="co">#&gt; $ address.country_code  &lt;chr&gt; "se"</span>
<span class="no">osm</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">lat</span>, <span class="no">lon</span>)
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   lat         lon              </span>
<span class="co">#&gt;   &lt;chr&gt;       &lt;chr&gt;            </span>
<span class="co">#&gt; 1 59.34986645 18.07063213298418</span>

<span class="co"># using MapQuest API</span>

<span class="no">mq</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="../reference/geocode_mapquest.html">geocode_mapquest</a></span>(
    <span class="kw">street</span> <span class="kw">=</span> <span class="st">"Kungliga Tekniska Högskolan"</span>,
    <span class="kw">zip</span> <span class="kw">=</span> <span class="st">"100 44"</span>,
    <span class="kw">city</span> <span class="kw">=</span> <span class="st">"Stockholm"</span>)

<span class="co"># coordinates etc</span>
<span class="no">mq</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_at</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html">vars</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">starts_with</a></span>(<span class="st">"admin"</span>)), <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/iconv.html">iconv</a></span>(<span class="no">x</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="st">"iso-8859-1"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span>(<span class="fl">2</span>) <span class="kw">%&gt;%</span>  <span class="co"># use only the second result</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>()
<span class="co">#&gt; Rows: 1</span>
<span class="co">#&gt; Columns: 24</span>
<span class="co">#&gt; $ street             &lt;chr&gt; ""</span>
<span class="co">#&gt; $ adminArea6         &lt;chr&gt; ""</span>
<span class="co">#&gt; $ adminArea6Type     &lt;chr&gt; "Neighborhood"</span>
<span class="co">#&gt; $ adminArea5         &lt;chr&gt; "Stockholms kommun"</span>
<span class="co">#&gt; $ adminArea5Type     &lt;chr&gt; "City"</span>
<span class="co">#&gt; $ adminArea4         &lt;chr&gt; ""</span>
<span class="co">#&gt; $ adminArea4Type     &lt;chr&gt; "County"</span>
<span class="co">#&gt; $ adminArea3         &lt;chr&gt; "STOCKHOLMS LÄN"</span>
<span class="co">#&gt; $ adminArea3Type     &lt;chr&gt; "State"</span>
<span class="co">#&gt; $ adminArea1         &lt;chr&gt; "SE"</span>
<span class="co">#&gt; $ adminArea1Type     &lt;chr&gt; "Country"</span>
<span class="co">#&gt; $ postalCode         &lt;chr&gt; ""</span>
<span class="co">#&gt; $ geocodeQualityCode &lt;chr&gt; "A5XAX"</span>
<span class="co">#&gt; $ geocodeQuality     &lt;chr&gt; "CITY"</span>
<span class="co">#&gt; $ dragPoint          &lt;lgl&gt; FALSE</span>
<span class="co">#&gt; $ sideOfStreet       &lt;chr&gt; "N"</span>
<span class="co">#&gt; $ linkId             &lt;chr&gt; "283537418"</span>
<span class="co">#&gt; $ unknownInput       &lt;chr&gt; ""</span>
<span class="co">#&gt; $ type               &lt;chr&gt; "s"</span>
<span class="co">#&gt; $ mapUrl             &lt;chr&gt; "http://www.mapquestapi.com/staticmap/v5/map?key=l…</span>
<span class="co">#&gt; $ latLng.lat         &lt;dbl&gt; 59.33377</span>
<span class="co">#&gt; $ latLng.lng         &lt;dbl&gt; 18.02822</span>
<span class="co">#&gt; $ displayLatLng.lat  &lt;dbl&gt; 59.33377</span>
<span class="co">#&gt; $ displayLatLng.lng  &lt;dbl&gt; 18.02822</span></pre></body></html></div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Markus Skyttner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
